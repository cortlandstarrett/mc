#!/bin/bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
export MASL_BIN_DIR=$DIR/

# maslout:  "i:d:p:ks"
# masl:  "cvVsi:o:d:p:a:"
# i, d, p and s mean the same thing for both applications.
args=`getopt i:d:p:o:kcsvV $*`
if [ $? != 0 ]
then
  echo 'Usage:  xtuml2masl [-v | -V] [-xf] [-xl] -i <eclipse project> -d <domain component> [-o <output directory>] [-a <architecture>'
  echo '        xtuml2masl [-v | -V] [-xf] [-xl] -i <eclipse project> -p <project package> [-o <output directory>] [-a <architecture>'
  exit 2
fi
set -- $args
for i
do
  case "$i"
  in
  -k)
    key_lett="-k"; shift;;
  -s)
    skip_activities="-s"; shift;;
  -i)
    project_directory="-i $2"; shift; shift;;
  -d)
    domain="-d $2"; shift; shift;;
  -p)
    project_package="-p $2"; shift; shift;;
  -v)
    validate="-v"; shift;;
  -v)
    validate_only="-V"; shift;;
  -o)
    output_directory="-o $2"; shift; shift;;
  -a)
    architecture="-a $2"; shift; shift;;
  --)
    shift; break;;
  esac
done
echo " $DIR/../../../plugins/org.xtuml.bp.pkg*/globals/Globals.xtuml | $DIR/x2m $key_lett $skip_activities $project_directory $domain $project_package $@ | $DIR/masl $coverage $validate $validate_only $skip_activities $project_directory $domain $project $output_directory $architecture $@"
cat $DIR/../../../plugins/org.xtuml.bp.pkg*/globals/Globals.xtuml | $DIR/x2m $key_lett $skip_activities $project_directory $domain $project_package $@ | $DIR/masl $coverage $validate $validate_only $skip_activities $project_directory $domain $project $output_directory $architecture $@
